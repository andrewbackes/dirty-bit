#ifndef bitboard_h
#define bitboard_h

#include "parameters.h"

typedef unsigned long long bitboard;
typedef unsigned char bitrow;
typedef unsigned long long phash_lock;

enum { h=0,g,f,e,d,c,b,a };

enum {	
		h1,g1,f1,e1,d1,c1,b1,a1,
		h2,g2,f2,e2,d2,c2,b2,a2,
		h3,g3,f3,e3,d3,c3,b3,a3,
		h4,g4,f4,e4,d4,c4,b4,a4,
		h5,g5,f5,e5,d5,c5,b5,a5,
		h6,g6,f6,e6,d6,c6,b6,a6,
		h7,g7,f7,e7,d7,c7,b7,a7,
		h8,g8,f8,e8,d8,c8,b8,a8
	};


namespace mask {
	const bitboard file[8] = {72340172838076673, 144680345676153346,289360691352306692, 578721382704613384, 1157442765409226768, 2314885530818453536, 4629771061636907072, 9259542123273814144};
	const bitboard rank[9] = {0, 255, 65280, 16711680, 4278190080, 1095216660480, 280375465082880, 71776119061217280, 18374686479671623680};
	const bitboard square[65] = {1,2, 4, 8, 16, 32, 64, 128, 
						256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 
						65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 
						16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 
						4294967296, 8589934592, 17179869184, 34359738368, 68719476736, 137438953472, 274877906944, 549755813888, 
						1099511627776, 2199023255552, 4398046511104, 8796093022208, 17592186044416, 35184372088832, 70368744177664, 140737488355328, 
						281474976710656, 562949953421312, 1125899906842624, 2251799813685248, 4503599627370496, 9007199254740992, 18014398509481984, 36028797018963968,
						72057594037927936, 144115188075855872, 288230376151711744, 576460752303423488, 1152921504606846976, 2305843009213693952, 4611686018427387904, 9223372036854775808, 0 };
	const bitboard north[65] = {72340172838076672,144680345676153344,289360691352306688,578721382704613376,1157442765409226752,2314885530818453504,4629771061636907008,9259542123273814016,72340172838076416,144680345676152832,289360691352305664,578721382704611328,1157442765409222656,2314885530818445312,4629771061636890624,9259542123273781248,72340172838010880,144680345676021760,289360691352043520,578721382704087040,1157442765408174080,2314885530816348160,4629771061632696320,9259542123265392640,72340172821233664,144680345642467328,289360691284934656,578721382569869312,1157442765139738624,2314885530279477248,4629771060558954496,9259542121117908992,72340168526266368,144680337052532736,289360674105065472,578721348210130944,1157442696420261888,2314885392840523776,4629770785681047552,9259541571362095104,72339069014638592,144678138029277184,289356276058554368,578712552117108736,1157425104234217472,2314850208468434944,4629700416936869888,9259400833873739776,72057594037927936,144115188075855872,288230376151711744,576460752303423488,1152921504606846976,2305843009213693952,4611686018427387904,9223372036854775808,0,0,0,0,0,0,0,0,0};
	const bitboard east[65] = {0, 1, 3, 7, 15, 31, 63, 127, 0, 256, 768, 1792, 3840, 7936, 16128, 32512, 0, 65536, 196608, 458752, 983040, 2031616, 4128768, 8323072, 0, 16777216, 50331648, 117440512, 251658240, 520093696, 1056964608, 2130706432, 0, 4294967296, 12884901888, 30064771072, 64424509440, 133143986176, 270582939648, 545460846592, 0, 1099511627776, 3298534883328, 7696581394432, 16492674416640, 34084860461056, 69269232549888, 139637976727552, 0, 281474976710656, 844424930131968, 1970324836974592, 4222124650659840, 8725724278030336, 17732923532771328, 35747322042253312, 0, 72057594037927936, 216172782113783808, 504403158265495552, 1080863910568919040, 2233785415175766016, 4539628424389459968, 9151314442816847872,0};
	const bitboard south[65] = {0,0,0,0,0,0,0,0,1,2,4,8,16,32,64,128,257,514,1028,2056,4112,8224,16448,32896,65793,131586,263172,526344,1052688,2105376,4210752,8421504,16843009,33686018,67372036,134744072,269488144,538976288,1077952576,2155905152,4311810305,8623620610,17247241220,34494482440,68988964880,137977929760,275955859520,551911719040,1103823438081,2207646876162,4415293752324,8830587504648,17661175009296,35322350018592,70644700037184,141289400074368,282578800148737,565157600297474,1130315200594948,2260630401189896,4521260802379792,9042521604759584,18085043209519168,36170086419038336,0};
	const bitboard west[65] = {254, 252, 248, 240, 224, 192, 128, 0, 65024, 64512, 63488, 61440, 57344, 49152, 32768, 0, 16646144, 16515072, 16252928, 15728640, 14680064, 12582912, 8388608, 0, 4261412864, 4227858432, 4160749568, 4026531840, 3758096384, 3221225472, 2147483648, 0, 1090921693184, 1082331758592, 1065151889408, 1030792151040, 962072674304, 824633720832, 549755813888, 0, 279275953455104, 277076930199552, 272678883688448, 263882790666240, 246290604621824, 211106232532992, 140737488355328, 0, 71494644084506624, 70931694131085312, 69805794224242688, 67553994410557440, 63050394783186944, 54043195528445952, 36028797018963968, 0, 18302628885633695744, 18158513697557839872, 17870283321406128128, 17293822569102704640, 16140901064495857664, 13835058055282163712, 9223372036854775808, 0,0};
	const bitboard nw[65] = {9241421688590303744, 36099303471055872, 141012904183808, 550831656960, 2151686144, 8404992, 32768, 0, 4620710844295151616, 9241421688590303232, 36099303471054848, 141012904181760, 550831652864, 2151677952, 8388608, 0, 2310355422147510272, 4620710844295020544, 9241421688590041088, 36099303470530560, 141012903133184, 550829555712, 2147483648, 0, 1155177711056977920, 2310355422113955840, 4620710844227911680, 9241421688455823360, 36099303202095104, 141012366262272, 549755813888, 0, 577588851233521664, 1155177702467043328, 2310355404934086656, 4620710809868173312, 9241421619736346624, 36099165763141632, 140737488355328, 0, 288793326105133056, 577586652210266112, 1155173304420532224, 2310346608841064448, 4620693217682128896, 9241386435364257792, 36028797018963968, 0, 144115188075855872, 288230376151711744, 576460752303423488, 1152921504606846976, 2305843009213693952, 4611686018427387904, 9223372036854775808, 0, 0, 0, 0, 0, 0, 0, 0, 0,0};
	const bitboard ne[65] = {0, 256, 66048, 16909312, 4328785920, 1108169199616, 283691315109888, 72624976668147712, 0, 65536, 16908288, 4328783872, 1108169195520, 283691315101696, 72624976668131328, 145249953336262656, 0, 16777216, 4328521728, 1108168671232, 283691314053120, 72624976666034176, 145249953332068352, 290499906664136704, 0, 4294967296, 1108101562368, 283691179835392, 72624976397598720, 145249952795197440, 290499905590394880, 580999811180789760, 0, 1099511627776, 283673999966208, 72624942037860352, 145249884075720704, 290499768151441408, 580999536302882816, 1161999072605765632, 0, 281474976710656, 72620543991349248, 145241087982698496, 290482175965396992, 580964351930793984, 1161928703861587968, 2323857407723175936, 0, 72057594037927936, 144115188075855872, 288230376151711744, 576460752303423488, 1152921504606846976, 2305843009213693952, 4611686018427387904, 0, 0, 0, 0, 0, 0, 0, 0,0};
	const bitboard se[65] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 8, 16, 32, 64, 0, 256, 513, 1026, 2052, 4104, 8208, 16416, 0, 65536, 131328, 262657, 525314, 1050628, 2101256, 4202512, 0, 16777216, 33619968, 67240192, 134480385, 268960770, 537921540, 1075843080, 0, 4294967296, 8606711808, 17213489152, 34426978560, 68853957121, 137707914242, 275415828484, 0, 1099511627776, 2203318222848, 4406653222912, 8813306511360, 17626613022976, 35253226045953, 70506452091906, 0, 281474976710656, 564049465049088, 1128103225065472, 2256206466908160, 4512412933881856, 9024825867763968, 18049651735527937,0};
	const bitboard sw[65] = {0, 0, 0, 0, 0, 0, 0, 0, 2, 4, 8, 16, 32, 64, 128, 0, 516, 1032, 2064, 4128, 8256, 16512, 32768, 0, 132104, 264208, 528416, 1056832, 2113664, 4227072, 8388608, 0, 33818640, 67637280, 135274560, 270549120, 541097984, 1082130432, 2147483648, 0, 8657571872, 17315143744, 34630287488, 69260574720, 138521083904, 277025390592, 549755813888, 0, 2216338399296, 4432676798592, 8865353596928, 17730707128320, 35461397479424, 70918499991552, 140737488355328, 0, 567382630219904, 1134765260439552, 2269530520813568, 4539061024849920, 9078117754732544, 18155135997837312, 36028797018963968, 0,0};
	const bitboard pawn_captures[2][65] = {{512, 1280, 2560, 5120, 10240, 20480, 40960, 16384, 131072, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 4194304, 33554432, 83886080, 167772160, 335544320, 671088640, 1342177280, 2684354560, 1073741824, 8589934592, 21474836480, 42949672960, 85899345920, 171798691840, 343597383680, 687194767360, 274877906944, 2199023255552, 5497558138880, 10995116277760, 21990232555520, 43980465111040, 87960930222080, 175921860444160, 70368744177664, 562949953421312, 1407374883553280, 2814749767106560, 5629499534213120, 11258999068426240, 22517998136852480, 45035996273704960, 18014398509481984, 144115188075855872, 360287970189639680, 720575940379279360, 1441151880758558720, 2882303761517117440, 5764607523034234880, 11529215046068469760, 4611686018427387904, 0, 0, 0, 0, 0, 0, 0, 0,0},{0, 0, 0, 0, 0, 0, 0, 0, 2, 5, 10, 20, 40, 80, 160, 64, 512, 1280, 2560, 5120, 10240, 20480, 40960, 16384, 131072, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 4194304, 33554432, 83886080, 167772160, 335544320, 671088640, 1342177280, 2684354560, 1073741824, 8589934592, 21474836480, 42949672960, 85899345920, 171798691840, 343597383680, 687194767360, 274877906944, 2199023255552, 5497558138880, 10995116277760, 21990232555520, 43980465111040, 87960930222080, 175921860444160, 70368744177664, 562949953421312, 1407374883553280, 2814749767106560, 5629499534213120, 11258999068426240, 22517998136852480, 45035996273704960, 18014398509481984,0}};
	const bitboard king_moves[65] = {770, 1797, 3594, 7188, 14376, 28752, 57504, 49216, 197123, 460039, 920078, 1840156, 3680312, 7360624, 14721248, 12599488, 50463488, 117769984, 235539968, 471079936, 942159872, 1884319744, 3768639488, 3225468928, 12918652928, 30149115904, 60298231808, 120596463616, 241192927232, 482385854464, 964771708928, 825720045568, 3307175149568, 7718173671424, 15436347342848, 30872694685696, 61745389371392, 123490778742784, 246981557485568, 211384331665408, 846636838289408, 1975852459884544, 3951704919769088, 7903409839538176, 15806819679076352, 31613639358152704, 63227278716305408, 54114388906344448, 216739030602088448, 505818229730443264, 1011636459460886528, 2023272918921773056, 4046545837843546112, 8093091675687092224, 16186183351374184448, 13853283560024178688, 144959613005987840, 362258295026614272, 724516590053228544, 1449033180106457088, 2898066360212914176, 5796132720425828352, 11592265440851656704, 4665729213955833856,0};
	const bitboard knight_moves[65] = {132096, 329728, 659712, 1319424, 2638848, 5277696, 10489856, 4202496, 33816580, 84410376, 168886289, 337772578, 675545156, 1351090312, 2685403152, 1075839008, 8657044482, 21609056261, 43234889994, 86469779988, 172939559976, 345879119952, 687463207072, 275414786112, 2216203387392, 5531918402816, 11068131838464, 22136263676928, 44272527353856, 88545054707712, 175990581010432, 70506185244672, 567348067172352, 1416171111120896, 2833441750646784, 5666883501293568, 11333767002587136, 22667534005174272, 45053588738670592, 18049583422636032, 145241105196122112, 362539804446949376, 725361088165576704, 1450722176331153408, 2901444352662306816, 5802888705324613632, 11533718717099671552, 4620693356194824192, 288234782788157440, 576469569871282176, 1224997833292120064, 2449995666584240128, 4899991333168480256, 9799982666336960512, 1152939783987658752, 2305878468463689728, 1128098930098176, 2257297371824128, 4796069720358912, 9592139440717824, 19184278881435648, 38368557762871296, 4679521487814656, 9077567998918656,0};
	const bitboard pawn_advances[2][65] = {{256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 4294967296, 8589934592, 17179869184, 34359738368, 68719476736, 137438953472, 274877906944, 549755813888, 1099511627776, 2199023255552, 4398046511104, 8796093022208, 17592186044416, 35184372088832, 70368744177664, 140737488355328, 281474976710656, 562949953421312, 1125899906842624, 2251799813685248, 4503599627370496, 9007199254740992, 18014398509481984, 36028797018963968, 72057594037927936, 144115188075855872, 288230376151711744, 576460752303423488, 1152921504606846976, 2305843009213693952, 4611686018427387904, 9223372036854775808, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 4294967296, 8589934592, 17179869184, 34359738368, 68719476736, 137438953472, 274877906944, 549755813888, 1099511627776, 2199023255552, 4398046511104, 8796093022208, 17592186044416, 35184372088832, 70368744177664, 140737488355328, 281474976710656, 562949953421312, 1125899906842624, 2251799813685248, 4503599627370496, 9007199254740992, 18014398509481984, 36028797018963968, 0}};
	const bitboard pawn_double_advances[2][65] = { {0,0,0,0,0,0,0,0, square[h4],square[g4],square[f4],square[e4],square[d4],square[c4],square[b4],square[a4], 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0}, 
												   {0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, square[h5],square[g5],square[f5],square[e5],square[d5],square[c5],square[b5],square[a5], 0,0,0,0,0,0,0,0, 0}};

	const bitboard royal_rank[2][8] = {{square[0],square[1], square[2], square[3], square[4], square[5], square[6], square[7]},{square[56],square[57],square[58],square[59],square[60],square[61],square[62],square[63]}};

	extern bitboard ray[64][64];

	//For Castling:
	const bitboard qRook_spawn[2] = {square[a1],square[a8]};
	const bitboard kRook_spawn[2] = {square[h1],square[h8]};
	const bitboard kBishop_spawn[2] = {square[f1],square[f8]};
	const bitboard king_spawn[2] = {square[e1],square[e8]};
	const bitboard queen_spawn[2] = {square[d1],square[d8]};
	const bitboard qCastle[2] = {square[c1],square[c8]};
	const bitboard kCastle[2] = {square[g1], square[g8]};
	const bitboard qCastle_path[2] = {{112},{8070450532247928832}};
	const bitboard kCastle_path[2] = {{6},{432345564227567616}};
	
	//For en passant:
	const bitboard pawns_spawn[2] = {rank[2],rank[7]};
	const bitboard pawn_double_jump[2] = {rank[4],rank[5]};
	const bitboard pawn_enPassant[2][65] = {{0,0,0,0,0,0,0,0, square[h3],square[g3],square[f3],square[e3],square[d3],square[c3],square[b3],square[a3], 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0,  0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,  square[h6],square[g6],square[f6],square[e6],square[d6],square[c6],square[b6],square[a6], 0,0,0,0,0,0,0,0}};

	//For evaluation:
	const bitboard trapped_rook_short_king[] = { 6, 432345564227567616 };
	const bitboard trapped_rook_short[] = { 259, 216454257090494464 };
	const bitboard trapped_rook_long_king[] = { 96, 6917529027641081856 };
	const bitboard trapped_rook_long[] = { 32960, 13871086852301127680 };
	const bitboard trapped_bishop_long[] = { 9077842876825600, 1077944320 };
	const bitboard trapped_bishop_short[] = { 1128107520032768, 33686528 };
	const bitboard short_castle_area[] = { 7, 504403158265495552 };
	const bitboard long_castle_area[] = { 224, 16140901064495857664 };
	const bitboard between_castle_area[] = { 6168, 1736137656351326208 };
	const bitboard short_castle_pawns[] = { 1792 ,  1970324836974592  };
	const bitboard long_castle_pawns[] = {  57344 ,  63050394783186944  };
	const bitboard mid_castle_pawns[] = { 7168 , 7881299347898368 };

	extern bitboard rule_of_the_square[2][64];

	const bitboard isolated_pawn[64] = {
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072,
		144680345676153346,361700864190383365,723401728380766730,1446803456761533460,2893606913523066920,5787213827046133840,11574427654092267680,4629771061636907072
	};
	const bitboard passed_pawn[2][64] = {{
			217020518514230016,
			506381209866536704,1012762419733073408,2025524839466146816,
			4051049678932293632,8102099357864587264,16204198715729174528,
			13889313184910721024,217020518514229248,506381209866534912,
			1012762419733069824,2025524839466139648,4051049678932279296,
			8102099357864558592,16204198715729117184,13889313184910671872,
			217020518514032640,506381209866076160,1012762419732152320,
			2025524839464304640,4051049678928609280,8102099357857218560,
			16204198715714437120,13889313184898088960,217020518463700992,
			506381209748635648,1012762419497271296,2025524838994542592,
			4051049677989085184,8102099355978170368,16204198711956340736,
			13889313181676863488,217020505578799104,506381179683864576,
			1012762359367729152,2025524718735458304,4051049437470916608,
			8102098874941833216,16204197749883666432,13889312357043142656,
			217017207043915776,506373483102470144,1012746966204940288,
			2025493932409880576,4050987864819761152,8101975729639522304,
			16203951459279044608,13889101250810609664,216172782113783808,
			504403158265495552,1008806316530991104,2017612633061982208,
			4035225266123964416,8070450532247928832,16140901064495857664,
			13835058055282163712,0,0,0,0,0,0,0,0
		},{
			0,0,0,0,0,0,0,0,3,7,
			14,28,56,
			112,224,192,
			771,1799,3598,
			7196,14392,28784,
			57568,49344,197379,
			460551,921102,1842204,
			3684408,7368816,14737632,
			12632256,50529027,117901063,
			235802126,471604252,943208504,
			1886417008,3772834016,3233857728,
			12935430915,30182672135,60365344270,
			120730688540,241461377080,482922754160,
			965845508320,827867578560,3311470314243,
			7726764066567,15453528133134,30907056266268,
			61814112532536,123628225065072,247256450130144,
			211934100111552,847736400446211,1978051601041159,
			3956103202082318,7912206404164636,15824412808329272,
			31648825616658544,63297651233317088,54255129628557504
	}};

	//For Magics:
	

	/*
	const bitboard MagicRookMask[] = {
		0x000101010101017Eull, 0x000202020202027Cull, 0x000404040404047Aull,
		0x0008080808080876ull, 0x001010101010106Eull, 0x002020202020205Eull,
		0x004040404040403Eull, 0x008080808080807Eull, 0x0001010101017E00ull,
		0x0002020202027C00ull, 0x0004040404047A00ull, 0x0008080808087600ull,
		0x0010101010106E00ull, 0x0020202020205E00ull, 0x0040404040403E00ull,
		0x0080808080807E00ull, 0x00010101017E0100ull, 0x00020202027C0200ull,
		0x00040404047A0400ull, 0x0008080808760800ull, 0x00101010106E1000ull,
		0x00202020205E2000ull, 0x00404040403E4000ull, 0x00808080807E8000ull,
		0x000101017E010100ull, 0x000202027C020200ull, 0x000404047A040400ull,
		0x0008080876080800ull, 0x001010106E101000ull, 0x002020205E202000ull,
		0x004040403E404000ull, 0x008080807E808000ull, 0x0001017E01010100ull,
		0x0002027C02020200ull, 0x0004047A04040400ull, 0x0008087608080800ull,
		0x0010106E10101000ull, 0x0020205E20202000ull, 0x0040403E40404000ull,
		0x0080807E80808000ull, 0x00017E0101010100ull, 0x00027C0202020200ull,
		0x00047A0404040400ull, 0x0008760808080800ull, 0x00106E1010101000ull,
		0x00205E2020202000ull, 0x00403E4040404000ull, 0x00807E8080808000ull,
		0x007E010101010100ull, 0x007C020202020200ull, 0x007A040404040400ull,
		0x0076080808080800ull, 0x006E101010101000ull, 0x005E202020202000ull,
		0x003E404040404000ull, 0x007E808080808000ull, 0x7E01010101010100ull,
		0x7C02020202020200ull, 0x7A04040404040400ull, 0x7608080808080800ull,
		0x6E10101010101000ull, 0x5E20202020202000ull, 0x3E40404040404000ull,
		0x7E80808080808000ull
	};

	const bitboard MagicRookNumbers[] = {
		0x0080001020400080ull, 0x0040001000200040ull, 0x0080081000200080ull,
		0x0080040800100080ull, 0x0080020400080080ull, 0x0080010200040080ull,
		0x0080008001000200ull, 0x0080002040800100ull, 0x0000800020400080ull,
		0x0000400020005000ull, 0x0000801000200080ull, 0x0000800800100080ull,
		0x0000800400080080ull, 0x0000800200040080ull, 0x0000800100020080ull,
		0x0000800040800100ull, 0x0000208000400080ull, 0x0000404000201000ull,
		0x0000808010002000ull, 0x0000808008001000ull, 0x0000808004000800ull,
		0x0000808002000400ull, 0x0000010100020004ull, 0x0000020000408104ull,
		0x0000208080004000ull, 0x0000200040005000ull, 0x0000100080200080ull,
		0x0000080080100080ull, 0x0000040080080080ull, 0x0000020080040080ull,
		0x0000010080800200ull, 0x0000800080004100ull, 0x0000204000800080ull,
		0x0000200040401000ull, 0x0000100080802000ull, 0x0000080080801000ull,
		0x0000040080800800ull, 0x0000020080800400ull, 0x0000020001010004ull,
		0x0000800040800100ull, 0x0000204000808000ull, 0x0000200040008080ull,
		0x0000100020008080ull, 0x0000080010008080ull, 0x0000040008008080ull,
		0x0000020004008080ull, 0x0000010002008080ull, 0x0000004081020004ull,
		0x0000204000800080ull, 0x0000200040008080ull, 0x0000100020008080ull,
		0x0000080010008080ull, 0x0000040008008080ull, 0x0000020004008080ull,
		0x0000800100020080ull, 0x0000800041000080ull, 0x00FFFCDDFCED714Aull,
		0x007FFCDDFCED714Aull, 0x003FFFCDFFD88096ull, 0x0000040810002101ull,
		0x0001000204080011ull, 0x0001000204000801ull, 0x0001000082000401ull,
		0x0001FFFAABFAD1A2ull};

		const unsigned char MagicRookShift[] = {
		52, 53, 53, 53, 53, 53, 53, 52,
		53, 54, 54, 54, 54, 54, 54, 53,
		53, 54, 54, 54, 54, 54, 54, 53,
		53, 54, 54, 54, 54, 54, 54, 53,
		53, 54, 54, 54, 54, 54, 54, 53,
		53, 54, 54, 54, 54, 54, 54, 53,
		53, 54, 54, 54, 54, 54, 54, 53,
		53, 54, 54, 53, 53, 53, 53, 53
	};

	*/
	/*
	const bitboard MagicBishopNumbers[] = {
		0x0002020202020200ull, 0x0002020202020000ull, 0x0004010202000000ull,
		0x0004040080000000ull, 0x0001104000000000ull, 0x0000821040000000ull,
		0x0000410410400000ull, 0x0000104104104000ull, 0x0000040404040400ull,
		0x0000020202020200ull, 0x0000040102020000ull, 0x0000040400800000ull,
		0x0000011040000000ull, 0x0000008210400000ull, 0x0000004104104000ull,
		0x0000002082082000ull, 0x0004000808080800ull, 0x0002000404040400ull,
		0x0001000202020200ull, 0x0000800802004000ull, 0x0000800400A00000ull,
		0x0000200100884000ull, 0x0000400082082000ull, 0x0000200041041000ull,
		0x0002080010101000ull, 0x0001040008080800ull, 0x0000208004010400ull,
		0x0000404004010200ull, 0x0000840000802000ull, 0x0000404002011000ull,
		0x0000808001041000ull, 0x0000404000820800ull, 0x0001041000202000ull,
		0x0000820800101000ull, 0x0000104400080800ull, 0x0000020080080080ull,
		0x0000404040040100ull, 0x0000808100020100ull, 0x0001010100020800ull,
		0x0000808080010400ull, 0x0000820820004000ull, 0x0000410410002000ull,
		0x0000082088001000ull, 0x0000002011000800ull, 0x0000080100400400ull,
		0x0001010101000200ull, 0x0002020202000400ull, 0x0001010101000200ull,
		0x0000410410400000ull, 0x0000208208200000ull, 0x0000002084100000ull,
		0x0000000020880000ull, 0x0000001002020000ull, 0x0000040408020000ull,
		0x0004040404040000ull, 0x0002020202020000ull, 0x0000104104104000ull,
		0x0000002082082000ull, 0x0000000020841000ull, 0x0000000000208800ull,
		0x0000000010020200ull, 0x0000000404080200ull, 0x0000040404040400ull,
		0x0002020202020200ull
	};

	const bitboard MagicBishopMask[] = {
		0x0040201008040200ull, 0x0000402010080400ull, 0x0000004020100A00ull,
		0x0000000040221400ull, 0x0000000002442800ull, 0x0000000204085000ull,
		0x0000020408102000ull, 0x0002040810204000ull, 0x0020100804020000ull,
		0x0040201008040000ull, 0x00004020100A0000ull, 0x0000004022140000ull,
		0x0000000244280000ull, 0x0000020408500000ull, 0x0002040810200000ull,
		0x0004081020400000ull, 0x0010080402000200ull, 0x0020100804000400ull,
		0x004020100A000A00ull, 0x0000402214001400ull, 0x0000024428002800ull,
		0x0002040850005000ull, 0x0004081020002000ull, 0x0008102040004000ull,
		0x0008040200020400ull, 0x0010080400040800ull, 0x0020100A000A1000ull,
		0x0040221400142200ull, 0x0002442800284400ull, 0x0004085000500800ull,
		0x0008102000201000ull, 0x0010204000402000ull, 0x0004020002040800ull,
		0x0008040004081000ull, 0x00100A000A102000ull, 0x0022140014224000ull,
		0x0044280028440200ull, 0x0008500050080400ull, 0x0010200020100800ull,
		0x0020400040201000ull, 0x0002000204081000ull, 0x0004000408102000ull,
		0x000A000A10204000ull, 0x0014001422400000ull, 0x0028002844020000ull,
		0x0050005008040200ull, 0x0020002010080400ull, 0x0040004020100800ull,
		0x0000020408102000ull, 0x0000040810204000ull, 0x00000A1020400000ull,
		0x0000142240000000ull, 0x0000284402000000ull, 0x0000500804020000ull,
		0x0000201008040200ull, 0x0000402010080400ull, 0x0002040810204000ull,
		0x0004081020400000ull, 0x000A102040000000ull, 0x0014224000000000ull,
		0x0028440200000000ull, 0x0050080402000000ull, 0x0020100804020000ull,
		0x0040201008040200ull
	};

	const unsigned char MagicBishopShift[] = {
		58, 59, 59, 59, 59, 59, 59, 58,
		59, 59, 59, 59, 59, 59, 59, 59,
		59, 59, 57, 57, 57, 57, 59, 59,
		59, 59, 57, 55, 55, 57, 59, 59,
		59, 59, 57, 55, 55, 57, 59, 59,
		59, 59, 57, 57, 57, 57, 59, 59,
		59, 59, 59, 59, 59, 59, 59, 59,
		58, 59, 59, 59, 59, 59, 59, 58 
	};
	*/
	
	const bitboard MagicRookMask[64] = {
		0x000101010101017e,	0x000202020202027c,	0x000404040404047a,	0x0008080808080876,	
		0x001010101010106e,	0x002020202020205e,	0x004040404040403e,	0x008080808080807e,	0x0001010101017e00,	0x0002020202027c00,	
		0x0004040404047a00,	0x0008080808087600,	0x0010101010106e00,	0x0020202020205e00,	0x0040404040403e00,	0x0080808080807e00,	
		0x00010101017e0100,	0x00020202027c0200,	0x00040404047a0400,	0x0008080808760800,	0x00101010106e1000,	0x00202020205e2000,	
		0x00404040403e4000,	0x00808080807e8000,	0x000101017e010100,	0x000202027c020200,	0x000404047a040400,	0x0008080876080800,	
		0x001010106e101000,	0x002020205e202000,	0x004040403e404000,	0x008080807e808000,	0x0001017e01010100,	0x0002027c02020200,	
		0x0004047a04040400,	0x0008087608080800,	0x0010106e10101000,	0x0020205e20202000,	0x0040403e40404000,	0x0080807e80808000,	
		0x00017e0101010100,	0x00027c0202020200,	0x00047a0404040400,	0x0008760808080800,	0x00106e1010101000,	0x00205e2020202000,	
		0x00403e4040404000,	0x00807e8080808000,	0x007e010101010100,	0x007c020202020200,	0x007a040404040400,	0x0076080808080800,	
		0x006e101010101000,	0x005e202020202000,	0x003e404040404000,	0x007e808080808000,	0x7e01010101010100,	0x7c02020202020200,	
		0x7a04040404040400,	0x7608080808080800,	0x6e10101010101000,	0x5e20202020202000,	0x3e40404040404000,	0x7e80808080808000
	};
		
	
	const bitboard MagicBishopMask[64] = {
		0x0040201008040200, 0x0000402010080400, 0x0000004020100a00, 0x0000000040221400,	
		0x0000000002442800, 0x0000000204085000, 0x0000020408102000, 0x0002040810204000, 0x0020100804020000, 0x0040201008040000,	
		0x00004020100a0000, 0x0000004022140000, 0x0000000244280000, 0x0000020408500000, 0x0002040810200000, 0x0004081020400000,	
		0x0010080402000200, 0x0020100804000400, 0x004020100a000a00, 0x0000402214001400, 0x0000024428002800, 0x0002040850005000,	
		0x0004081020002000, 0x0008102040004000, 0x0008040200020400, 0x0010080400040800, 0x0020100a000a1000, 0x0040221400142200,	
		0x0002442800284400, 0x0004085000500800, 0x0008102000201000, 0x0010204000402000, 0x0004020002040800, 0x0008040004081000,	
		0x00100a000a102000, 0x0022140014224000, 0x0044280028440200, 0x0008500050080400, 0x0010200020100800, 0x0020400040201000,	
		0x0002000204081000, 0x0004000408102000, 0x000a000a10204000, 0x0014001422400000, 0x0028002844020000, 0x0050005008040200,	
		0x0020002010080400, 0x0040004020100800, 0x0000020408102000, 0x0000040810204000, 0x00000a1020400000, 0x0000142240000000,	
		0x0000284402000000, 0x0000500804020000, 0x0000201008040200, 0x0000402010080400, 0x0002040810204000, 0x0004081020400000,	
		0x000a102040000000, 0x0014224000000000, 0x0028440200000000, 0x0050080402000000, 0x0020100804020000, 0x0040201008040200
	};
	
	#ifdef USE_9_12_MAGICS

	#define MAGIC_ROOK_SIZE		4096 //4096 //16384
	#define MAGIC_BISHOP_SIZE	512  //512	 //2048

	const unsigned char MagicRookShift[] = {
		//Dan's 12 bit shifts
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52,
		52, 52, 52, 52, 52, 52, 52, 52
	};	
	
	const bitboard MagicRookNumbers[64]	 = {
		//Dan's 12 bit magics
		0xa8002c000108020, 0x100084000802070, 0x8180048020009000, 0x102002110000800,
		0x100023302040800, 0x220012000884b108, 0x2010158412000040, 0x880004024800100, 0x1a41800010400020, 0xba00500c800,
		0x2000c8120005, 0x200080a002840, 0x2e00600800900c, 0x408004808022204, 0x8002440a24040082, 0x19400244008020,
		0x1003428000108024, 0x81020108003c0100, 0x42800820100100, 0x6c00204200030040, 0x4082000811a40100, 0x4820848820008040,
		0x920100a00004008, 0x2081820000241041, 0x9009214104008000, 0x214016004090, 0x804108040080041, 0x1204024010010440,
		0x828040080020800, 0xd02040028040486, 0x18004c020800100, 0x8000040860044080, 0x8030021008600021, 0x80488100404,
		0x40420110880008, 0x1401401023020580, 0x2041000605000410, 0x3c08400c041000b3, 0x8400120090c02485, 0x10200804002a0,
		0x6100a21402000, 0xa2108008085008, 0x1826080004001000, 0x120040a42002000a, 0xc004128000888, 0x80041004c0,
		0x8140184000442c80, 0x4000010298420004, 0x100403000a51008, 0x8888040900c6020, 0x68000a00200420, 0xb0300a0084400200,
		0x200c02400020040, 0x8030004220508, 0xa04a0001000480, 0x20020008810, 0x11b0080002241, 0xd004284000104901,
		0xd808c200104282, 0x420201a90000805, 0x100900500480001, 0x40004980a440011, 0x110048420520401, 0x800011040280c422
	};
	
	const unsigned char MagicBishopShift[] = {
		//Dan's 9s
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55, 
		55, 55, 55, 55, 55, 55, 55, 55 
	};
	
	const bitboard MagicBishopNumbers[64] =	{	
		// Dan's 9 bit magics
		0x150510001100a407, 0x1020040820240400, 0x4801400808800208, 0x20469c0108004001,
		0x2390084002941, 0x11a120201808041c, 0x185000b00900080, 0x801801080984001, 0x40022a84420201, 0x1000120010304202,
		0x1140004a52008080, 0x860042030281010, 0x405c10000001, 0x300c03022b10214, 0x1212941ac002000, 0x6031210a00a4084,
		0x8000500282300410, 0x8009002800602044, 0x2004000085000600, 0x2060a8f0050004, 0x4410482200500003, 0x82090020d000,
		0xa404006a0500100, 0x2011022040048020, 0x484012041002680, 0x100808020040100, 0xc0050040388080c0, 0x20280201004008,
		0x1001041024008, 0x4058820036220020, 0x600a011022003000, 0x1380380800c12040, 0xa002824040a10420, 0xa02c305108880052,
		0x61000080042, 0x3200020080080080, 0xc2004040000c030, 0x14010020c0000920, 0x20840301011082, 0xa400682204252,
		0x500008010a942080, 0x8004086880320100, 0x34110a6010a00200, 0x86400e20080, 0x808400403000818, 0x1330d02010100020,
		0x21002490030001a, 0x9c1800802a102, 0xcd02280040a10040, 0x2488420820100000, 0x2e11118022010041, 0x1400400a000,
		0x838010440308019, 0x80014304002124, 0x2204848008002, 0x2008452801010100, 0x2040400482200120, 0xa000a208a98,
		0x860244212005060, 0x8400200058410080, 0x10011201002824, 0x4100041080108, 0x4050210a29080040, 0x508204090680
	};
	
	#endif

	#ifdef USE_11_14_MAGICS

	#define MAGIC_ROOK_SIZE		16384 //4096 //16384
	#define MAGIC_BISHOP_SIZE	2048  //512	 //2048

	const unsigned char MagicRookShift[] = {
		//Dan's 14 bit shifts
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50,
		50, 50, 50, 50, 50, 50, 50, 50
	};
	const bitboard MagicRookNumbers[64] = {
	   //Dan's 14 bit magics
		0x3dda061861b36e5c,	0x70594a4b3143359a,	0x68a6220f6daa52c0,	0x1f196c34657d1a44,	
		0x172747536927491e,	0x6616090d5fed34c5,	0x4f0d532c5bc45539,	0x6a8836c7211d7265,	0x04f178936c5f2331,	0x78df04f72cde6d3c,	
		0x7b1078ea3dd343c5,	0x3a230ca030183a5f,	0x32ed299c65442ff4,	0x0762340406a34a5b,	0x01eb26e941bb5af1,	0x4a804e012f943774,	
		0x1e022d3627f025be,	0x6b36729f708f1d33,	0x11097fac38e86b8c,	0x5bed48ac02562374,	0x0b947ab979d001d4,	0x2a154a7079dd57da,	
		0x72f56b9068ee777d,	0x1a430d0a324e09cc,	0x6fe953a831a01a6e,	0x4c036f7959352889,	0x502e565951db4fd0,	0x579a410737fe2965,	
		0x11c27bc471835ee2,	0x461e5067338c082d,	0x78fd076f27b52a75,	0x7e2e50dc44925d39,	0x3afa3bba27204b50,	0x736f216906c22682,	
		0x191613b46fd31f6e,	0x6bda55f23e0d0d65,	0x79595f490bef61d2,	0x398672645ffc1340,	0x7b636659502b707e,	0x58dd45ed70e51e39,	
		0x424c3fcd35d82cbd,	0x18bc25dd4f5700fd,	0x7dfc0f091ab25aac,	0x11d2253f44a123dc,	0x46216ba752211966,	0x52897b37232e2aff,	
		0x52ec6b03524e0abf,	0x23ad1e51097d572c,	0x62c3159c29fa3282,	0x2283557876e77899,	0x7dbd2965735115b8,	0x51cf1abe20bf5bd7,	
		0x30073eb433ea5f1f,	0x744738185dfd5f64,	0x62677d851f623ba9,	0x1bf957ab32b27077,	0x72d55f6175d869e6,	0x75a636bf42b41c42,	
		0x208416e365286b23,	0x2f4442ef564a0bf5,	0x6bd94bf551a75bef,	0x622f6fb036d33252,	0x70ec11865b1a152f,	0x082e3e370f801366
	   };
	const unsigned char MagicBishopShift[] = {
		//Dan's 11s
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53, 
		53, 53, 53, 53, 53, 53, 53, 53 
	};
	const bitboard MagicBishopNumbers[64] = {	
		// Dan's 11 bit magics
		0x678418be48230029,	0x72ae2cd63d6c4ae1,	0x6df116495f906952,	0x01eb26e941bb5af1,	
		0x153c12db2ea60bb3,	0x00990f3e390c7e87,	0x491c440d305e0124,	0x54de15474db74d06,	0x26a6428b66bb6443,	0x767d7a5a5d03701f,	
		0x1e1f3b2512384509,	0x6bfc63cb1ad46e5d,	0x030a6b89260d2213,	0x073256ae0bdb301c,	0x22ee2350759a0120,	0x5cfd6b3658784b40,	
		0x3bf65f321a493e12,	0x0ddc5f49797d3a9e,	0x7eb7423066c4366b,	0x73da121f798b12e1,	0x047e6ad62f140fbf,	0x2c49465775ef7983,	
		0x261e7dd122cd3a61,	0x61721916489c5e9d,	0x71f0401d32e66b72,	0x0677494a7f4f0384,	0x50396be818d74402,	0x0bb57e0620fd41d8,	
		0x45f45b4053cf3e62,	0x0f5577785a173a32,	0x25075a5a1b02022e,	0x697870713c277853,	0x36402ae444923d23,	0x6cb5549c45bc7ca4,	
		0x74b942a910ba0cab,	0x57302ecf5de12f85,	0x6d2e40ae7fb75781,	0x784c7a386cd95b87,	0x00ed4a025e2a0ceb,	0x25311a5013a16146,	
		0x1ceb3d353afa7f31,	0x5e2f3c5c47c47502,	0x65641ba777cc6751,	0x34a112a4020079a0,	0x24bf7b1263c262b0,	0x210a3f823344485b,	
		0x2aad67af44a96219,	0x04587dd8361078f4,	0x0943240b1c540f41,	0x778277764e9b08f0,	0x48ab70a62b610efc,	0x2b784bba1ab6238f,	
		0x48324347782d5154,	0x530f3a441f905736,	0x18bf3d2331d2416a,	0x39421e41264513af,	0x04fc31807c0d68d4,	0x300b6b321fd52b7b,	
		0x4fd8663a59c14c1e,	0x56ec156d57a3184f,	0x716a4a9b35f70f92,	0x4d7b181225c91a39,	0x4d8c7a38127c66e1,	0x0e7732da30bd3815
	};
	#endif

	extern bitboard MagicRookMoves[64][MAGIC_ROOK_SIZE];
	extern bitboard MagicBishopMoves[64][MAGIC_BISHOP_SIZE];

};

//short bitcnt(bitboard * bb);
unsigned char bitcount(bitboard bb);

//short bitscan_lsb(bitboard * bb);
unsigned char bitscan_lsb(bitboard bb);

//short bitscan_msb(bitboard * bb);
unsigned char bitscan_msb(bitboard bb);
//unsigned char bitscan_msb2(bitboard bb);

//bool bitcheck(bitboard * bb, short index);
bool bitcheck(bitboard bb, unsigned char index);

void bitprint(bitboard bb);

void populateMagicRookArray() ;
void populateMagicBishopArray() ;
void initializeMagicBishops() ;

#endif